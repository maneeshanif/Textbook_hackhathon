# Implementation Plan: Docusaurus Book Site

**Branch**: `001-docusaurus-book` | **Date**: 2025-12-06 | **Spec**: [spec.md](./spec.md)
**Input**: Feature specification from `/specs/001-docusaurus-book/spec.md`

## Summary

Build an interactive, accessible online textbook for "Physical AI and Humanoid Robotics" using Docusaurus 3.x. The site will support multi-language content (English + Urdu with RTL), dark/light themes, and include a chatbot placeholder for Phase 2 integration. Initial scaffold includes 4 chapters with X.Y.Z numbering structure per constitution.

## Technical Context

**Language/Version**: TypeScript/JavaScript (Node.js 18+)  
**Primary Dependencies**: Docusaurus 3.x, React 18, MDX 3  
**Storage**: N/A (static site, filesystem-based content)  
**Testing**: Jest (unit), Playwright (E2E)  
**Target Platform**: Web (GitHub Pages / Vercel)  
**Project Type**: Web application (documentation/book site)  
**Performance Goals**: Page load < 3 seconds, Lighthouse 90+  
**Constraints**: Mobile responsive (320px+), WCAG 2.1 AA accessibility  
**Scale/Scope**: ~4 chapters, ~20 pages, 2 languages (EN/UR)

## Constitution Check

*GATE: All constitution principles verified*

| Principle | Status | Implementation |
|-----------|--------|----------------|
| 1. Context7-First | ✅ | Docusaurus docs fetched via Context7 before research |
| 2. Subagent Delegation | ✅ | Route to `book-builder` agent for implementation |
| 3. TDD | ✅ | Jest for components, Playwright for navigation |
| 4. Security | ✅ | Static site, no secrets required |
| 5. Accessibility | ✅ | ARIA labels, semantic HTML, keyboard nav |
| 6. Chapter Structure | ✅ | X.Y.Z numbering in folder/file structure |
| 7. Smallest Diff | ✅ | Scaffold only, content written iteratively |
| 8. Docs as Code | ✅ | README in each directory |
| 9. Localization-Ready | ✅ | i18n configured with RTL for Urdu |
| 10. Definition of Done | ✅ | Checklist per PR |

## Project Structure

### Documentation (this feature)

```text
specs/001-docusaurus-book/
├── spec.md              # Feature specification
├── plan.md              # This file
├── research.md          # Context7 findings for Docusaurus
├── data-model.md        # Chapter/Section/Exercise entities
├── quickstart.md        # Developer setup guide
├── contracts/           # Component interfaces
│   ├── DifficultyBadge.ts
│   ├── ChatbotPlaceholder.ts
│   └── ChapterHeader.ts
└── tasks.md             # Implementation tasks (next: /sp.tasks)
```

### Source Code (repository root)

```text
book/
├── docusaurus.config.ts    # Main config with i18n
├── sidebars.ts             # Autogenerated sidebar config
├── package.json            # Dependencies
├── tsconfig.json           # TypeScript config
├── README.md               # Project documentation
├── src/
│   ├── components/         # Reusable MDX components
│   │   ├── DifficultyBadge/
│   │   │   ├── index.tsx
│   │   │   └── styles.module.css
│   │   ├── ChatbotPlaceholder/
│   │   │   ├── index.tsx
│   │   │   └── styles.module.css
│   │   └── ChapterHeader/
│   │       ├── index.tsx
│   │       └── styles.module.css
│   ├── css/
│   │   ├── custom.css      # Theme overrides
│   │   └── rtl.css         # RTL styles for Urdu
│   ├── theme/
│   │   └── MDXComponents.tsx  # Global component registration
│   └── pages/
│       └── index.tsx       # Homepage
├── docs/                   # English content
│   ├── 01-introduction/
│   │   ├── _category_.json
│   │   ├── 1.0-overview.mdx
│   │   ├── 1.1-what-is-physical-ai.mdx
│   │   ├── 1.2-history-evolution.mdx
│   │   ├── 1.3-exercises.mdx
│   │   └── 1.4-summary.mdx
│   ├── 02-humanoid-robotics/
│   │   ├── _category_.json
│   │   ├── 2.0-overview.mdx
│   │   └── ...
│   ├── 03-sensors-actuators/
│   │   ├── _category_.json
│   │   ├── 3.0-overview.mdx
│   │   └── ...
│   └── 04-ai-integration/
│       ├── _category_.json
│       ├── 4.0-overview.mdx
│       └── ...
├── i18n/
│   └── ur/                 # Urdu translations
│       ├── docusaurus-theme-classic/
│       │   ├── navbar.json
│       │   └── footer.json
│       └── docusaurus-plugin-content-docs/
│           └── current/
│               └── 01-introduction/
│                   └── 1.0-overview.mdx  # Sample translation
├── static/
│   └── img/
│       ├── logo.svg
│       └── favicon.ico
└── tests/
    ├── unit/
    │   └── components/
    │       └── DifficultyBadge.test.tsx
    └── e2e/
        └── navigation.spec.ts
```

**Structure Decision**: Single project with `/book` subdirectory to keep documentation site separate from project specs and tooling.

## Key Technical Decisions

### 1. i18n Configuration

```typescript
// docusaurus.config.ts
export default {
  i18n: {
    defaultLocale: 'en',
    locales: ['en', 'ur'],
    localeConfigs: {
      en: { label: 'English', direction: 'ltr', htmlLang: 'en-US' },
      ur: { label: 'اردو', direction: 'rtl', htmlLang: 'ur-PK' },
    },
  },
};
```

### 2. Sidebar Autogeneration

```typescript
// sidebars.ts
export default {
  bookSidebar: [{ type: 'autogenerated', dirName: '.' }],
};
```

With `_category_.json` in each chapter folder for metadata.

### 3. Global MDX Components

```typescript
// src/theme/MDXComponents.tsx
import MDXComponents from '@theme-original/MDXComponents';
import DifficultyBadge from '@site/src/components/DifficultyBadge';
import ChatbotPlaceholder from '@site/src/components/ChatbotPlaceholder';

export default { ...MDXComponents, DifficultyBadge, ChatbotPlaceholder };
```

### 4. Theme Configuration

```typescript
// docusaurus.config.ts
export default {
  themeConfig: {
    colorMode: {
      defaultMode: 'light',
      respectPrefersColorScheme: true,
    },
    navbar: {
      items: [
        { type: 'localeDropdown', position: 'right' },
      ],
    },
    prism: {
      theme: prismThemes.github,
      darkTheme: prismThemes.dracula,
    },
  },
};
```

## Generated Artifacts

| Artifact | Path | Status |
|----------|------|--------|
| Research | `specs/001-docusaurus-book/research.md` | ✅ Complete |
| Data Model | `specs/001-docusaurus-book/data-model.md` | ✅ Complete |
| Quickstart | `specs/001-docusaurus-book/quickstart.md` | ✅ Complete |
| DifficultyBadge Contract | `specs/001-docusaurus-book/contracts/DifficultyBadge.ts` | ✅ Complete |
| ChatbotPlaceholder Contract | `specs/001-docusaurus-book/contracts/ChatbotPlaceholder.ts` | ✅ Complete |
| ChapterHeader Contract | `specs/001-docusaurus-book/contracts/ChapterHeader.ts` | ✅ Complete |
| Tasks | `specs/001-docusaurus-book/tasks.md` | ⏳ Next: /sp.tasks |

## Dependencies

External packages to install:

```json
{
  "dependencies": {
    "@docusaurus/core": "^3.6.0",
    "@docusaurus/preset-classic": "^3.6.0",
    "@mdx-js/react": "^3.0.0",
    "react": "^18.2.0",
    "react-dom": "^18.2.0",
    "prism-react-renderer": "^2.3.0"
  },
  "devDependencies": {
    "@docusaurus/module-type-aliases": "^3.6.0",
    "@docusaurus/types": "^3.6.0",
    "@types/react": "^18.2.0",
    "typescript": "^5.3.0",
    "@playwright/test": "^1.40.0",
    "jest": "^29.7.0",
    "@testing-library/react": "^14.1.0"
  }
}
```

## Next Steps

1. **Run `/sp.tasks`** to generate implementation task breakdown
2. **Initialize Docusaurus** with `npx create-docusaurus@latest book classic --typescript`
3. **Configure i18n and theme** per research findings
4. **Scaffold chapters** with placeholder content
5. **Implement custom components**
6. **Add Urdu sample translation**
7. **Write tests and validate accessibility**

## Risks & Mitigations

| Risk | Impact | Mitigation |
|------|--------|------------|
| RTL layout issues | Medium | Test early with Urdu locale; use Docusaurus native RTL |
| Component accessibility | High | Follow ARIA patterns; test with screen reader |
| i18n complexity | Medium | Start with 1 sample translation; iterate |
| Build performance | Low | Docusaurus handles caching; keep images optimized |
